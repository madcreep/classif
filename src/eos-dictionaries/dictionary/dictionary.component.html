<div class="eos-dictionary"
    [ngClass]="{'full': currentState[0] && currentState[1] && !hideTree,
        'only-selected': !currentState[0] && !currentState[1] || currentState[0] && !currentState[1] && hideTree,
        'info': !currentState[0] && currentState[1] || currentState[0] && currentState[1] && hideTree,
        'tree': currentState[0] && !currentState[1] && !hideTree}"
    (transitionend)="transitionEnd()">
    <div class="tree-wrapper block"
        #tree
        [ngClass]="{'open-tree': currentState[0] && !hideTree, 'has-spinner': !treeNodes.length }"
        [hidden]="this.dictionary?.descriptor.type === dictTypes.linear">
        <eos-spinner *ngIf="!treeNodes.length"
            size="lg"></eos-spinner>
        <eos-tree *ngIf="treeNodes.length"
            [nodes]="treeNodes"
            [showDeleted]="params.showDeleted"></eos-tree>
        <div class="fon highlighted"
            [style.width]="fonConf.width"
            [style.height]="fonConf.height"
            [style.top]="fonConf.top"></div>
    </div>
    <div class="selected-wrapper"
        #selectedWrapper
        [ngClass]="{'open-tree': currentState[0] && !hideTree }">
        <div class="node-actions">
            <div *ngIf="treeNode"
                class="selected-node xl-font"
                [ngClass]="{'has-custom': hasCustomTable}">
                <div class="go-top-wrapper">
                    <button *ngIf="hasParent"
                        class="btn btn-primary-light"
                        (click)="goUp()">
                        <span class="eos-icon eos-icon-arrow-blue-left"></span>
                    </button>
                </div>

                <ng-container *ngIf="this.isTitleSliced; then slicedTitle else nonSlicedTitle"></ng-container>
                <ng-template #slicedTitle>
                    <div class="selected-node-title"
                    [tooltip]='this.title'
                    placement="bottom"
                    container="body"
                    containerClass="tooltip-info">
                        <span class="long-title xl-font">{{sliced_title}}</span>
                    </div>
                </ng-template>
                <ng-template #nonSlicedTitle>
                    <div class="selected-node-title">
                        <span class="long-title xl-font">{{this.title}}</span>
                    </div>
                </ng-template>

                <div class="tabs-wrapper usual-border m-font">
                    <ul class="tabs"
                        *ngIf="dictionary?.id === 'departments'">
                        <li class="tab-item"
                            role="presentation"
                            [ngClass]="{'active': dictMode === 1}"
                            (click)="setDictMode(1)">
                            <span class="tab-title">Кабинеты</span>
                        </li>
                        <li class="tab-item"
                            role="presentation"
                            [ngClass]="{'active': dictMode === 0}"
                            (click)="setDictMode(0)">
                            <span class="tab-title">Подразделения</span>
                        </li>
                    </ul>
                </div>
                <div class="item-count usual-border m-font">
                    <ng-container *ngIf="params.searchResults; then foundRecords; else records"></ng-container>
                    <ng-template #records>
                        <span class="item-count-content">
                            Записей:
                            <span class="counter">{{paginationConfig?.itemsQty}}</span>
                        </span>
                    </ng-template>
                    <ng-template #foundRecords>
                        <span class="item-count-found">
                            Найдено <span class="counter">{{paginationConfig?.itemsQty}}</span> записей
                        <button class="btn btn-primary-light"
                            tooltip="Очистить результаты"
                            placement="bottom"
                            container="body"
                            containerClass="tooltip-info"
                            (click)=resetSearch()><span class="eos-icon eos-icon-close-blue small"></span></button>
                        </span>
                    </ng-template>
                </div>
            </div>
            <div class="first-line" [hidden]="params.hideTopMenu">
                <div class="controller pull-left">
                    <eos-node-actions (action)="doAction($event)"></eos-node-actions>
                </div>
                <div class="pull-right">
                    <eos-dictionary-search (switchFastSrch)="switchFastSearch($event)"></eos-dictionary-search>
                </div>
            </div>
            <eos-dictionary-quick-search *ngIf="fastSearch"></eos-dictionary-quick-search>
        </div>
        <eos-node-list #nodeList></eos-node-list>
        <eos-node-list-pagination [currentState]="[currentState[0] && !hideTree, currentState[1]]"></eos-node-list-pagination>
    </div>
    <div class="opened-wrapper block"
        [ngClass]="{'open-info': currentState[1]}">
        <div class="info-spinner">
            <eos-spinner *ngIf="params.updatingInfo"
                size="lg"></eos-spinner>
        </div>
        <eos-node-info-switcher *ngIf="!params.updatingInfo"></eos-node-info-switcher>
    </div>
</div>
